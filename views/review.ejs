<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Review Submission</title>
    <link rel="stylesheet" href="/nadeendb/review.css">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">

    <!--By: Nadeen Abu Hilweh  -->
    <style>
        /* Additional styles for review display */
        .review-container {
            margin-top: 40px;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
        }
        
        .review-box {
            background: rgba(30, 30, 30, 0.9);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid #8400ff;
        }
        
        .review-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .avatar {
            font-size: 24px;
            margin-right: 15px;
        }
        
        .rating-stars {
            color: gold;
            font-size: 18px;
            margin: 5px 0;
        }
        
        .review-text {
            line-height: 1.6;
            margin-bottom: 5px;
        }
        
        .review-date {
            font-size: 12px;
            color: #aaa;
        }
    </style>
</head>

<body>
    <!-- Navigation Header -->
    <header>
        <div class="navbar">
            <button class="navbar-menu-btn">
                <span class="one"></span>
                <span class="two"></span>
                <span class="three"></span>
            </button>

            <a style="color: bisque; font-family: monospace; font-size: 2em;" href="#home" class="navbar-brand">
                NadMovies
            </a>

            <nav>
                <ul class="navbar-nav">
                    <li> <a href="#home" class="navbar-link">Home</a> </li>
                    <li> <a href="#category" class="navbar-link">Category</a> </li>
                    <li> <a href="#about" class="navbar-link">About</a> </li>
                    <li> <a href="#review" class="navbar-link">Review</a> </li>
                </ul>
            </nav>
            
            <div class="row">
                <div class="search-box">
                    <button class="btn-search"><i class="uil uil-search"></i></button>
                    <input class="input-search" type="text" id="myFilter" onkeyup="filterReviews()" placeholder="Search reviews...">
                </div>
            </div>
        </div>
    </header>

    <!-- Full-screen background video -->
    <video autoplay muted loop id="background-video">
        <source src="/nadeendb/video/vid.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <!-- Dark overlay for better readability -->
    <div class="overlay"></div>

    <!-- Content section -->
    <div class="content">
        <h2>🎬 Submit Your Movie Review</h2>

        <div id="successMessage" class="success-message">
            Thank you for your review! Your submission has been received.
        </div>

        <form id="reviewForm" action="/submit-review" method="POST">
            <div class="form-group">
                <label for="username">Your Name:</label>
                <input type="text" id="username" name="username" required>
                <span id="usernameError" class="error"></span>
            </div>
            <div class="form-group">
                <label for="movieTitle">Movie Title:</label>
                <input type="text" id="movieTitle" name="movieTitle" required>
                <span id="movieTitleError" class="error"></span>
            </div>
            <div class="form-group">
                <label for="releaseYear">Release Year:</label>
                <input type="number" id="releaseYear" name="releaseYear" min="1900" max="<%= new Date().getFullYear() %>" required>
                <span id="releaseYearError" class="error"></span>
            </div>
            <div class="form-group">
                <label for="rating">Rating (1-5):</label>
                <input type="number" id="rating" name="rating" min="1" max="5" required>
                <span id="ratingError" class="error"></span>
            </div>
            <div class="form-group">
                <label for="review">Your Review:</label>
                <textarea id="review" name="review" rows="4" required></textarea>
                <span id="reviewError" class="error"></span>
            </div>
            <button type="submit">Submit Review</button>
        </form>

        <!-- Reviews Display Section -->
        <div class="review-container">
            <h2>Recent Reviews</h2>
            
            <% function getRandomAvatar() { 
                const avatars = ['🎥', '🎬', '🍿', '📽️', '🎞️', '👤'];
                return avatars[Math.floor(Math.random() * avatars.length)];
            } %>
            
            <% if (reviews.length > 0) { %>
                <% reviews.forEach(review => { %>
                    <div class="review-box">
                        <div class="review-header">
                            <div class="avatar"><%= getRandomAvatar() %></div>
                            <div>
                                <h3><%= review.movieTitle %></h3>
                                <span class="year">(<%= review.releaseYear %>)</span>
                            </div>
                        </div>
                        <div class="rating-stars">
                            <% for(let i=0; i<review.rating; i++) { %>★<% } %>
                            <% for(let i=review.rating; i<5; i++) { %>☆<% } %>
                        </div>
                        <div class="reviewer">By: <%= review.username %></div>
                        <p class="review-text"><%= review.review %></p>
                        <span class="review-date">Posted on: <%= review.dateAdded.toLocaleDateString() %></span>
                    </div>
                <% }); %>
            <% } else { %>
                <p class="no-reviews">No reviews yet. Be the first to review!</p>
            <% } %>
        </div>

        <footer>
            <div class="footer-content">     
            </div>
            <div class="footer-copyright">
                <div class="copyright">
                    <p>&copy; Copyright 2025 NadMovies</p>
                </div>
                <div class="wrapper">
                    <a href="#">NadeenAbuHilweh  ||</a>
                    <a href="#">Terms and conditions</a>
                </div>
            </div>
        </footer>
    </div>

    <script src="/nadeendb/review.js"></script>
            <script>
        // Search functionality
        function filterReviews() {
            const input = document.getElementById('myFilter');
            const filter = input.value.toUpperCase();
            const reviewBoxes = document.querySelectorAll('.review-box');
            
            reviewBoxes.forEach(box => {
                const title = box.querySelector('h3').textContent.toUpperCase();
                box.style.display = title.includes(filter) ? '' : 'none';
            });
        }
        
        // Hide success message by default
        document.getElementById('successMessage').style.display = 'none';
    </script>
</body>
</html>